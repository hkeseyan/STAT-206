---
title: "HovanesKeseyan_Lab4"
author: "Hovanes Keseyan"
date: "October 18, 2016"
output: pdf_document
---

## Part I

## 1 : OBP dataset statistics

```{r }
obp <- read.csv("http://faculty.ucr.edu/~jflegal/206/mlb-obp.csv")
summary(obp)

# Number of players included in the dataset:
nrow(obp)

# Minimum number of plate appearances for this list:
min(obp$PA)

# OBP statistics:
min(obp$OBP)
max(obp$OBP)
mean(obp$OBP)
```

There are 441 players in the dataset, with 103 plate appearances as the minimum. The minimum OBP is 0.168, maximum OBP is 0.432, and mean OBP is 0.3119184.

## 2 : Histogram of the data

```{r }
hist(obp$OBP, probability = TRUE)
abline(v=0.3119184)
```

The mean coincides with the interval that is tied for the mode of the distribution. This makes sense.

## 3 : Eyeball curve fit

```{r }
hist(obp$OBP, probability = TRUE)
abline(v=0.3119184)
curve(dbeta(x, .312, .688), add = TRUE, col="red")
curve(dbeta(x, 3.12, 6.88), add = TRUE, col="green")
curve(dbeta(x, 31.2, 68.8), add = TRUE, col="blue")
curve(dbeta(x, 312, 688), add = TRUE, col="orange")
```

The blue curve (sum of 100) is the closest to the observed distribution.

## Part II

## 4 : Method of moments fit

```{r }
m <- mean(obp$OBP)
v <- var(obp$OBP)
a <- m*(((m*(1-m))/v)-1)
b <- (1-m)*(((m*(1-m))/v)-1)
a
b

hist(obp$OBP, probability = TRUE)
abline(v=0.3119184)
curve(dbeta(x, a, b), add = TRUE, col="red")
```

This curve fits much better with the data than any of the previous curves. The estimate for alpha is 44.3169 and the estimate for beta is 97.76163.

## 5 : Calibration

```{r }
# create a vector to define each percent up to 99
percentiles <- seq(0, 0.99, 0.01)

# run the quantile function
q.obp <- quantile(obp$OBP, probs = percentiles)

# run the qbeta function
qb.obp <- qbeta(percentiles, a, b)

# plot the results from each function on the y-axis against the percentiles to compare the fit of the two results
plot(percentiles, q.obp, col="blue")
points(percentiles, qb.obp, col="red")
```

The fit of the 2 plots looks very similar. The values generated by both functions seem to be accurate. 

## 6 : log-likelihood

```{r }

ll <- function(p = c(a,b)) {
  ll.sum <- -sum(dbeta(obp$OBP, p[1], p[2], log = TRUE))
  
  return(ll.sum)
}

nlm(ll, c(a,b))
```

The minimum of the negative log-likelihood is approximately -805.88. The estimate for alpha through this function is 43.73915, compared to the MOM fit estimate of 44.3169. The estimate for beta through this function is  96.49892, compared to the MOM fot estimate of 97.76163. The estimates for alpha and beta are both close, giving us confidence in the fit.